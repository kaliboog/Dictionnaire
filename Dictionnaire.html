<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Salto CP 2019 â€” Lecture: Mots par sons (offline)</title>
  <style>
    :root{
      --bg1:#f0f7ff; --bg2:#ffffff; --fg:#111827; --muted:#6b7280; --border:#e5e7eb; --brand:#0ea5e9; --accent:#11182710;
    }
    body{margin:0; background:linear-gradient(to bottom,var(--bg1),var(--bg2)); color:var(--fg); font-family:system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,sans-serif}
    header,footer{padding:12px 16px; max-width:1024px; margin:0 auto; width:100%}
    header{display:flex; align-items:center; justify-content:space-between; font-size:14px; color:var(--muted)}
    .grid{display:grid; gap:12px}
    .grid.letters{grid-template-columns:repeat(auto-fill,minmax(120px,1fr))}
    .tile{border:1px solid var(--border); background:#fff; border-radius:14px; padding:12px; text-align:center; min-height:90px; overflow:hidden}
    .tile .big{font-weight:900; font-size:22px; white-space:nowrap; overflow:hidden; text-overflow:ellipsis}
    .tile .sub{font-size:11px; color:var(--muted); margin-top:4px; white-space:nowrap; overflow:hidden; text-overflow:ellipsis}
    h3.week{margin:16px 4px 8px; font-size:14px; color:var(--muted)}
    .centercol{display:flex; flex-direction:column; align-items:center; gap:12px; margin-top:20px}
    .bigword{font-weight:900; font-size:15vw; text-align:center}
    .emo{font-size:12vw}
    .btn{padding:10px 14px; border-radius:12px; border:1px solid var(--border); background:#fff; margin:4px}
    .controls{display:flex; gap:10px; justify-content:center; flex-wrap:wrap}
    select.hidden{display:none}
  </style>
</head>
<body>
  <header>
    <div><span style="color:var(--brand); font-weight:700">Salto CP 2019</span> â€” Mots par sons</div>
    <div>
      <label><input id="teacherToggle" type="checkbox"/> Mode enseignant</label>
      <button id="importBtn" class="btn" style="display:none">Importer</button>
      <span id="hdrRight" style="font-size:12px;color:var(--muted)"></span>
    </div>
  </header>

  <main style="max-width:1024px; margin:auto; padding:16px">
    <div id="screenHome">
      <h2>Accueil â€” SÃ©lection par semaine</h2>
      <div id="homeGrid"></div>
    </div>

    <div id="screenLesson" style="display:none">
      <div class="centercol">
        <div id="lessonMeta" style="font-size:12px;color:var(--muted)">Semaine â€”</div>
        <div id="emoji" class="emo">ðŸ”¤</div>
        <div id="word" class="bigword">Mot</div>
        <div class="controls">
          <button id="prevBtn" class="btn">â—€ï¸Ž</button>
          <button id="hearBtn" class="btn">ðŸ”Š</button>
          <button id="nextBtn" class="btn">â–¶ï¸Ž</button>
        </div>
        <div id="progress" style="font-size:12px;color:var(--muted)">1/1</div>
        <div class="controls">
          <button id="backBtn" class="btn">Accueil</button>
          <select id="variantSelect" class="btn"></select>
        </div>
      </div>
    </div>
  </main>

  <footer style="font-size:12px;color:var(--muted)">Â© 2025 â€¢ Ressource pÃ©dagogique horsâ€‘ligne â€¢ AlignÃ© Salto CP 2019</footer>

<script>
(function(){
  function shortLabel(l){ if(l.labelShort) return l.labelShort; if(l.title.length>8) return l.title.split('/')[0]+'â€¦'; return l.title; }
  const EMOJI={
  // Alphabet â€” A
  'ami':'ðŸ§‘â€ðŸ¤â€ðŸ§‘','Ã¢ne':'ðŸ´','arbre':'ðŸŒ³','avion':'âœˆï¸','arc':'ðŸ¹',
  // B
  'bateau':'â›µ','bÃ©bÃ©':'ðŸ‘¶','biscuit':'ðŸª','bonbon':'ðŸ¬','bureau':'ðŸ’¼',
  // C
  'cadeau':'ðŸŽ','carotte':'ðŸ¥•','cerise':'ðŸ’','citron':'ðŸ‹','cube':'ðŸ§Š',
  // D
  'dodo':'ðŸ˜´','dame':'ðŸ‘©','dinosaure':'ðŸ¦–','domino':'ðŸ£','dinde':'ðŸ¦ƒ',
  // E
  'Ã©cole':'ðŸ«','Ã©tÃ©':'â˜€ï¸','Ã©lÃ©phant':'ðŸ˜','Ã©toile':'â­','enfant':'ðŸ§’',
  // F
  'farine':'ðŸŒ¾','fleur':'ðŸŒ¸','fusÃ©e':'ðŸš€','forÃªt':'ðŸŒ²','famille':'ðŸ‘¨â€ðŸ‘©â€ðŸ‘§',
  // G
  'gÃ¢teau':'ðŸŽ‚','girafe':'ðŸ¦’','guitare':'ðŸŽ¸','gomme':'ðŸ§½','glace':'ðŸ¨',
  // H
  'haricot':'ðŸ«˜','hibou':'ðŸ¦‰','histoire':'ðŸ“–','hiver':'â„ï¸','hÃ©licoptÃ¨re':'ðŸš',
  // I
  'igloo':'ðŸ ','image':'ðŸ–¼ï¸','idÃ©e':'ðŸ’¡','insecte':'ðŸž','Ã®le':'ðŸï¸',
  // J
  'jupe':'ðŸ‘—','jardin':'ðŸŒ¼','jambe':'ðŸ¦µ','jaune':'ðŸŸ¨','jouet':'ðŸ§¸',
  // K
  'kiwi':'ðŸ¥','kangourou':'ðŸ¦˜','koala':'ðŸ¨','ketchup':'ðŸ…','kimono':'ðŸ‘˜',
  // L
  'lapin':'ðŸ°','livre':'ðŸ“–','lune':'ðŸŒ™','lait':'ðŸ¥›','lit':'ðŸ›ï¸',
  // M
  'maman':'ðŸ‘©','maison':'ðŸ ','moto':'ðŸï¸','musÃ©e':'ðŸ›ï¸','miel':'ðŸ¯',
  // N
  'neige':'â„ï¸','navire':'ðŸš¢','nuit':'ðŸŒ™','nuage':'â˜ï¸','nid':'ðŸªº',
  // O
  'orange':'ðŸŠ','ours':'ðŸ»','os':'ðŸ¦´','oiseau':'ðŸ¦','outil':'ðŸ› ï¸',
  // P
  'papa':'ðŸ‘¨','poisson':'ðŸŸ','pomme':'ðŸŽ','poule':'ðŸ”','puzzle':'ðŸ§©',
  // Q
  'quatre':'4ï¸âƒ£','question':'â“','quoi':'â“','quinze':'1ï¸âƒ£5ï¸âƒ£','aquarium':'ðŸ ',
  // R
  'roue':'ðŸ›ž','robot':'ðŸ¤–','rire':'ðŸ˜‚','rat':'ðŸ­','riviÃ¨re':'ðŸžï¸',
  // S
  'soleil':'â˜€ï¸','salade':'ðŸ¥—','sac':'ðŸ‘œ','sable':'ðŸ–ï¸','souris':'ðŸ­',
  // T
  'table':'ðŸª‘','tomate':'ðŸ…','tapis':'ðŸ§¶','tortue':'ðŸ¢','train':'ðŸš†',
  // U
  'uniforme':'ðŸŽ–ï¸','usine':'ðŸ­','unique':'âœ¨','ukulele':'ðŸŽ¸','urgence':'ðŸš‘',
  // V
  'vache':'ðŸ„','vÃ©lo':'ðŸš²','voiture':'ðŸš—','verre':'ðŸ¥›','violet':'ðŸŸ£',
  // W
  'wagon':'ðŸšƒ','wifi':'ðŸ“¶','whisky':'ðŸ¥ƒ','walkman':'ðŸŽ§','wow':'ðŸ¤©',
  // X
  'xylophone':'ðŸŽ¼','taxi':'ðŸš•','saxophone':'ðŸŽ·','boxe':'ðŸ¥Š','mix':'ðŸ”€',
  // Y
  'yaourt':'ðŸ¥›','yoyo':'ðŸª€','yoga':'ðŸ§˜','yack':'ðŸƒ','yÃ©ti':'ðŸ§Œ',
  // Z
  'zÃ¨bre':'ðŸ¦“','zÃ©ro':'0ï¸âƒ£','zoo':'ðŸ¦’','pizza':'ðŸ•','gaz':'ðŸ§ª',

  // Digrammes â€” CH
  'chat':'ðŸ±','chaise':'ðŸª‘','chocolat':'ðŸ«','chÃ¢teau':'ðŸ°','chemise':'ðŸ‘”',
  // GN
  'agneau':'ðŸ‘','montagne':'â›°ï¸','ligne':'ðŸ“','campagne':'ðŸžï¸','champignon':'ðŸ„',
  // OU
  'mouton':'ðŸ‘','bouche':'ðŸ‘„',
  // OI
  'trois':'3ï¸âƒ£','roi':'ðŸ‘‘',
  // AN/AM
  'manteau':'ðŸ§¥','panda':'ðŸ¼','banane':'ðŸŒ','tambour':'ðŸ¥','camping':'ðŸ•ï¸',
  // EN/EM
  'dent':'ðŸ¦·','argent':'ðŸ’¶','tente':'â›º','temps':'â³',
  // IN/IM
  'matin':'ðŸŒ…','chemin':'ðŸ›£ï¸','linge':'ðŸ§º','important':'â—',
  // AIN/EIN
  'pain':'ðŸ¥–','main':'ðŸ¤š','bain':'ðŸ›','sein':'â¤ï¸','plein':'ðŸˆµ',
  // ON/OM
  'bonbon':'ðŸ¬','ballon':'ðŸŽˆ','dragon':'ðŸ‰','pantalon':'ðŸ‘–','prÃ©nom':'ðŸªª',
  // EU/Å’U
  'feu':'ðŸ”¥','bleu':'ðŸ”µ','jeu':'ðŸŽ®','peu':'âž–','cheveux':'ðŸ’‡',
  // AU/EAU
  'eau':'ðŸ’§','cadeau':'ðŸŽ','chapeau':'ðŸŽ©',
  // ILL
  'fille':'ðŸ‘§','bille':'ðŸ”µ','gorille':'ðŸ¦','papillon':'ðŸ¦‹','vanille':'ðŸ¦',
  // CE/CI/Ã‡
  'garÃ§on':'ðŸ‘¦','leÃ§on':'ðŸ“','merci':'ðŸ™',
  // GE/GI
  'gÃ©ant':'ðŸ—¼','magie':'âœ¨','page':'ðŸ“„','rouge':'ðŸŸ¥',
  // GU
  'langue':'ðŸ‘…','aiguille':'ðŸª¡','guÃªpe':'ðŸ','pingouin':'ðŸ§',
  // QU â€” (quatre, question, quinze, aquarium, quoi) already mapped above
  // PH
  'photo':'ðŸ“¸','phoque':'ðŸ¦­','tÃ©lÃ©phone':'ðŸ“ž','pharmacie':'ðŸ’Š',
  // OIN/ION
  'coin':'ðŸª™','loin':'ðŸ“','avion':'âœˆï¸','camion':'ðŸšš','champion':'ðŸ†',

  // Groupes â€” BL
  'blanc':'âšª','blague':'ðŸ˜„','blÃ©':'ðŸŒ¾','blouson':'ðŸ§¥','bleu':'ðŸ”µ',
  // BR
  'bras':'ðŸ’ª','brioche':'ðŸ¥','brique':'ðŸ§±','brocoli':'ðŸ¥¦','brouillard':'ðŸŒ«ï¸',
  // CL
  'classe':'ðŸ«','cloche':'ðŸ””','clÃ©':'ðŸ—ï¸','clown':'ðŸ¤¡','club':'ðŸŸï¸',
  // CR
  'crabe':'ðŸ¦€','crÃ¨me':'ðŸ¨','crayon':'âœï¸','croissant':'ðŸ¥','cruche':'ðŸ«™',
  // DR
  'drapeau':'ðŸ³ï¸','dromadaire':'ðŸª','drÃ´le':'ðŸ˜„','drap':'ðŸ›ï¸',
  // FL
  'flamme':'ðŸ”¥','flÃ»te':'ðŸªˆ','flocon':'â„ï¸','flÃ¨che':'ðŸ¹',
  // FR
  'fraise':'ðŸ“','frÃ¨re':'ðŸ‘¦','frigo':'ðŸ§Š','fromage':'ðŸ§€','froid':'ðŸ¥¶',
  // GL
  'globe':'ðŸŒ','glisser':'ðŸ›¼','gluant':'ðŸŸ¢','glaÃ§on':'ðŸ§Š',
  // GR
  'grenade':'ðŸˆ','gris':'âšª','grotte':'ðŸ•³ï¸','grue':'ðŸ—ï¸','griffe':'ðŸ¾',
  // PL
  'plateau':'ðŸ½ï¸','plage':'ðŸ–ï¸','plume':'ðŸª¶','plan':'ðŸ—ºï¸','plat':'ðŸ½ï¸',
  // PR
  'prince':'ðŸ¤´','princesse':'ðŸ‘¸','prune':'ðŸ‘','proie':'ðŸ¦´',
  // TR
  'trÃ©sor':'ðŸª™','triangle':'ðŸ”º','trompette':'ðŸŽº','truc':'ðŸ§©'
};
  const LESSONS=[
  // ===== Alphabet (all letters) =====
  {id:'A',title:'A',week:'Alphabet',variants:[{label:'Mots',items:['ami','Ã¢ne','arbre','avion','arc']}]},
  {id:'B',title:'B',week:'Alphabet',variants:[{label:'Mots',items:['bateau','bÃ©bÃ©','biscuit','bonbon','bureau']}]},
  {id:'C',title:'C',week:'Alphabet',variants:[{label:'Mots',items:['cadeau','carotte','cerise','citron','cube']}]},
  {id:'D',title:'D',week:'Alphabet',variants:[{label:'Mots',items:['dodo','dame','dinosaure','domino','dinde']}]},
  {id:'E',title:'E',week:'Alphabet',variants:[{label:'Mots',items:['Ã©cole','Ã©tÃ©','Ã©lÃ©phant','Ã©toile','enfant']}]},
  {id:'F',title:'F',week:'Alphabet',variants:[{label:'Mots',items:['farine','fleur','fusÃ©e','forÃªt','famille']}]},
  {id:'G',title:'G',week:'Alphabet',variants:[{label:'Mots',items:['gÃ¢teau','girafe','guitare','gomme','glace']}]},
  {id:'H',title:'H',week:'Alphabet',variants:[{label:'Mots',items:['haricot','hibou','histoire','hiver','hÃ©licoptÃ¨re']}]},
  {id:'I',title:'I',week:'Alphabet',variants:[{label:'Mots',items:['igloo','image','idÃ©e','insecte','Ã®le']}]},
  {id:'J',title:'J',week:'Alphabet',variants:[{label:'Mots',items:['jupe','jardin','jambe','jaune','jouet']}]},
  {id:'K',title:'K',week:'Alphabet',variants:[{label:'Mots',items:['kiwi','kangourou','koala','ketchup','kimono']}]},
  {id:'L',title:'L',week:'Alphabet',variants:[{label:'Mots',items:['lapin','livre','lune','lait','lit']}]},
  {id:'M',title:'M',week:'Alphabet',variants:[{label:'Mots',items:['maman','maison','moto','musÃ©e','miel']}]},
  {id:'N',title:'N',week:'Alphabet',variants:[{label:'Mots',items:['neige','navire','nuit','nuage','nid']}]},
  {id:'O',title:'O',week:'Alphabet',variants:[{label:'Mots',items:['orange','ours','os','oiseau','outil']}]},
  {id:'P',title:'P',week:'Alphabet',variants:[{label:'Mots',items:['papa','poisson','pomme','poule','puzzle']}]},
  {id:'Q',title:'Q',week:'Alphabet',variants:[{label:'Mots',items:['quatre','question','quoi','quinze','aquarium']}]},
  {id:'R',title:'R',week:'Alphabet',variants:[{label:'Mots',items:['roue','robot','rire','rat','riviÃ¨re']}]},
  {id:'S',title:'S',week:'Alphabet',variants:[{label:'Mots',items:['soleil','salade','sac','sable','souris']}]},
  {id:'T',title:'T',week:'Alphabet',variants:[{label:'Mots',items:['table','tomate','tapis','tortue','train']}]},
  {id:'U',title:'U',week:'Alphabet',variants:[{label:'Mots',items:['uniforme','usine','unique','ukulele','urgence']}]},
  {id:'V',title:'V',week:'Alphabet',variants:[{label:'Mots',items:['vache','vÃ©lo','voiture','verre','violet']}]},
  {id:'W',title:'W',week:'Alphabet',variants:[{label:'Mots',items:['wagon','wifi','whisky','walkman','wow']}]},
  {id:'X',title:'X',week:'Alphabet',variants:[{label:'Mots',items:['xylophone','taxi','saxophone','boxe','mix']}]},
  {id:'Y',title:'Y',week:'Alphabet',variants:[{label:'Mots',items:['yaourt','yoyo','yoga','yack','yÃ©ti']}]},
  {id:'Z',title:'Z',week:'Alphabet',variants:[{label:'Mots',items:['zÃ¨bre','zÃ©ro','zoo','pizza','gaz']}]},

  // ===== Digraphes & voyelles complexes =====
  {id:'CH',title:'CH',week:'Digrammes',variants:[{label:'Mots',items:['chat','chaise','chocolat','chÃ¢teau','chemise']}]},
  {id:'GN',title:'GN',week:'Digrammes',variants:[{label:'Mots',items:['agneau','montagne','ligne','campagne','champignon']}]},
  {id:'OU',title:'OU',week:'Digrammes',variants:[{label:'Mots',items:['souris','poule','roue','mouton','bouche']}]},
  {id:'OI',title:'OI',week:'Digrammes',variants:[{label:'Mots',items:['oiseau','poisson','trois','roi','voiture']}]},
  {id:'AN',title:'AN/AM',week:'Digrammes',variants:[{label:'Mots',items:['manteau','panda','banane','tambour','camping']}]},
  {id:'EN',title:'EN/EM',week:'Digrammes',variants:[{label:'Mots',items:['enfant','dent','argent','tente','temps']}]},
  {id:'IN',title:'IN/IM',week:'Digrammes',variants:[{label:'Mots',items:['lapin','matin','chemin','linge','important']}]},
  {id:'AINEIN',title:'AIN/EIN',labelShort:'AIN/EIN',week:'Digrammes',variants:[{label:'Mots',items:['pain','main','bain','sein','plein']}]},
  {id:'ON',title:'ON/OM',week:'Digrammes',variants:[{label:'Mots',items:['bonbon','ballon','dragon','pantalon','prÃ©nom']}]},
  {id:'EU',title:'EU/Å’U',week:'Digrammes',variants:[{label:'Mots',items:['feu','bleu','jeu','peu','cheveux']}]},
  {id:'AU',title:'AU/EAU',week:'Digrammes',variants:[{label:'Mots',items:['eau','bateau','cadeau','chapeau','oiseau']}]},
  {id:'ILL',title:'ILL',week:'Digrammes',variants:[{label:'Mots',items:['fille','bille','gorille','papillon','vanille']}]},
  {id:'CECI',title:'CE/CI/Ã‡',labelShort:'CE/CI/Ã‡',week:'Digrammes',variants:[{label:'Mots',items:['cerise','citron','garÃ§on','leÃ§on','merci']}]},
  {id:'GEGI',title:'GE/GI',labelShort:'GE/GI',week:'Digrammes',variants:[{label:'Mots',items:['girafe','gÃ©ant','magie','page','rouge']}]},
  {id:'GU',title:'GU',week:'Digrammes',variants:[{label:'Mots',items:['guitare','langue','aiguille','guÃªpe','pingouin']}]},
  {id:'QU',title:'QU',week:'Digrammes',variants:[{label:'Mots',items:['quatre','question','quinze','aquarium','quoi']}]},
  {id:'PH',title:'PH',week:'Digrammes',variants:[{label:'Mots',items:['photo','phoque','tÃ©lÃ©phone','pharmacie','Ã©lÃ©phant']}]},
  {id:'OI N',title:'OIN/ION',labelShort:'OIN/ION',week:'Digrammes',variants:[{label:'Mots',items:['coin','loin','avion','camion','champion']}]},

  // ===== Groupes consonantiques =====
  {id:'BL',title:'BL',week:'Groupes',variants:[{label:'Mots',items:['blanc','blague','blÃ©','blouson','bleu']}]},
  {id:'BR',title:'BR',week:'Groupes',variants:[{label:'Mots',items:['bras','brioche','brique','brocoli','brouillard']}]},
  {id:'CL',title:'CL',week:'Groupes',variants:[{label:'Mots',items:['classe','cloche','clÃ©','clown','club']}]},
  {id:'CR',title:'CR',week:'Groupes',variants:[{label:'Mots',items:['crabe','crÃ¨me','crayon','croissant','cruche']}]},
  {id:'DR',title:'DR',week:'Groupes',variants:[{label:'Mots',items:['dragon','drapeau','dromadaire','drÃ´le','drap']}]},
  {id:'FL',title:'FL',week:'Groupes',variants:[{label:'Mots',items:['fleur','flamme','flÃ»te','flocon','flÃ¨che']}]},
  {id:'FR',title:'FR',week:'Groupes',variants:[{label:'Mots',items:['fraise','frÃ¨re','frigo','fromage','froid']}]},
  {id:'GL',title:'GL',week:'Groupes',variants:[{label:'Mots',items:['glace','globe','glisser','gluant','glaÃ§on']}]},
  {id:'GR',title:'GR',week:'Groupes',variants:[{label:'Mots',items:['grenade','gris','grotte','grue','griffe']}]},
  {id:'PL',title:'PL',week:'Groupes',variants:[{label:'Mots',items:['plateau','plage','plume','plan','plat']}]},
  {id:'PR',title:'PR',week:'Groupes',variants:[{label:'Mots',items:['prince','princesse','prune','prÃ©nom','proie']}]},
  {id:'TR',title:'TR',week:'Groupes',variants:[{label:'Mots',items:['train','trÃ©sor','triangle','trompette','truc']}]}
];

  const homeGrid=document.getElementById('homeGrid');
  const screenHome=document.getElementById('screenHome');
  const screenLesson=document.getElementById('screenLesson');
  const wordEl=document.getElementById('word');
  const emojiEl=document.getElementById('emoji');
  const progressEl=document.getElementById('progress');
  const lessonMeta=document.getElementById('lessonMeta');
  const variantSelect=document.getElementById('variantSelect');
  const hdrRight=document.getElementById('hdrRight');
  const teacherToggle=document.getElementById('teacherToggle');
  const importBtn=document.getElementById('importBtn');

  let currentLesson=null,curVariantIndex=0,i=0,teacherMode=false;

  teacherToggle.addEventListener('change',()=>{teacherMode=teacherToggle.checked;variantSelect.classList.toggle('hidden',!teacherMode);importBtn.style.display=teacherMode?'inline-block':'none'});

  function emojiFor(w){return EMOJI[w.toLowerCase()]||'ðŸ”¤'}
  function updateWord(){const items=currentLesson.variants[curVariantIndex].items;const w=items[i];wordEl.textContent=w.charAt(0).toUpperCase()+w.slice(1);emojiEl.textContent=emojiFor(w);progressEl.textContent=`${i+1}/${items.length}`;hdrRight.textContent=`${currentLesson.title} Â· ${i+1}/${items.length}`}
  function hear(){const text=currentLesson.variants[curVariantIndex].items[i];const u=new SpeechSynthesisUtterance(text);u.lang='fr-FR';speechSynthesis.cancel();setTimeout(()=>speechSynthesis.speak(u),10)}
  function renderLesson(){lessonMeta.textContent=`${currentLesson.week} â€” ${currentLesson.title}`;variantSelect.innerHTML='';currentLesson.variants.forEach((v,idx)=>{const o=document.createElement('option');o.value=idx;o.textContent=v.label;if(idx===curVariantIndex)o.selected=true;variantSelect.appendChild(o)});variantSelect.classList.toggle('hidden',!teacherMode);updateWord();screenHome.style.display='none';screenLesson.style.display='block'}
  function showLesson(id){const l=LESSONS.find(x=>x.id===id);if(!l)return;currentLesson=l;i=0;curVariantIndex=0;renderLesson()}

  function renderHome(){homeGrid.innerHTML='';const weekNum=w=>{const m=(w||'').match(/(\d+)/);return m?parseInt(m[1],10):999};const groups={};LESSONS.sort((a,b)=>weekNum(a.week)-weekNum(b.week)).forEach(l=>{if(!groups[l.week])groups[l.week]=[];groups[l.week].push(l)});Object.keys(groups).sort((a,b)=>weekNum(a)-weekNum(b)).forEach(week=>{const section=document.createElement('div');const h=document.createElement('h3');h.textContent=week;h.className='week';const grid=document.createElement('div');grid.className='grid letters';groups[week].forEach(l=>{const tile=document.createElement('button');tile.className='tile';tile.innerHTML=`<div class="big">${shortLabel(l)}</div><div class="sub">${l.title}</div>`;tile.addEventListener('click',()=>showLesson(l.id));grid.appendChild(tile)});section.appendChild(h);section.appendChild(grid);homeGrid.appendChild(section)})}

  document.getElementById('prevBtn').addEventListener('click',()=>{const items=currentLesson.variants[curVariantIndex].items;i=(i-1+items.length)%items.length;updateWord()})
  document.getElementById('nextBtn').addEventListener('click',()=>{const items=currentLesson.variants[curVariantIndex].items;i=(i+1)%items.length;updateWord()})
  document.getElementById('hearBtn').addEventListener('click',hear)
  document.getElementById('backBtn').addEventListener('click',()=>{screenLesson.style.display='none';screenHome.style.display='block';hdrRight.textContent=''})
  variantSelect.addEventListener('change',e=>{curVariantIndex=parseInt(e.target.value)||0;i=0;updateWord()})

  renderHome();
})();
</script>
</body>
</html>
